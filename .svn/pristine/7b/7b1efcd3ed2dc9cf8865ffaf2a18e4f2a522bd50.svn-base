<Window x:Class="Excel2Oracle.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Excel2Oracle"
        mc:Ignorable="d"
        Title="MainWindow"
        Height="500"
        Width="1000">
    <Grid Margin="0"
          x:Name="wholeGrid"
          VerticalAlignment="Stretch"
          HorizontalAlignment="Stretch">
        <Grid.ColumnDefinitions>
            <ColumnDefinition MinWidth="100"
                              Width="33*" />
            <ColumnDefinition MinWidth="390"
                              Width="33*" />
            <ColumnDefinition MinWidth="200"
                              Width="33*" />
        </Grid.ColumnDefinitions>
        <GridSplitter Width="5"
                      Grid.Column="0"></GridSplitter>
        <GridSplitter Width="5"
                      Grid.Column="1"></GridSplitter>
        <TreeView HorizontalAlignment="Stretch"
                  VerticalAlignment="Stretch"
                  Grid.Column="0"
                  Margin="0,0,10,0"
                  BorderThickness="0"
                  x:Name="TemplateTreeView"
                  SelectedItemChanged="TemplateTreeView_SelectedItemChanged">
            <TreeView.ItemContainerStyle>
                <Style TargetType="{x:Type TreeViewItem}">
                    <Setter Property="IsExpanded"
                            Value="{Binding IsExpanded}"></Setter>
                </Style>
            </TreeView.ItemContainerStyle>
            <TreeView.ItemTemplate>
                <HierarchicalDataTemplate  ItemsSource="{Binding Children}">
                    <StackPanel Orientation="Horizontal">
                        <Image VerticalAlignment="Center"
                               Source="{Binding Icon}"
                               Width="16"
                               Height="16"
                               Margin="0,0,2,2"></Image>
                        <TextBlock VerticalAlignment="Center"
                                   Name="nodeName"
                                   Text="{Binding DisplayName}"></TextBlock>
                        <Button VerticalAlignment="Center"
                                HorizontalAlignment="Center"
                                Width="15"
                                Height="15"
                                Margin="20,0,0,0"
                                Visibility="{Binding Visiblity}"
                                Click="ReloadTemplates">
                            <Button.Background>
                                <ImageBrush ImageSource="Images/refesh.jpg"
                                            Stretch="Fill" />
                            </Button.Background >
                        </Button>
                        <StackPanel.ToolTip>
                            <TextBlock VerticalAlignment="Center"
                                       Text="{Binding Path}"
                                       TextWrapping="Wrap"
                                       MaxWidth="200"></TextBlock>
                        </StackPanel.ToolTip>
                    </StackPanel>
                </HierarchicalDataTemplate>
            </TreeView.ItemTemplate>
        </TreeView>
        <Grid Grid.Column="1"
              x:Name="opGrid"
              Margin="10,0,0,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="40"></RowDefinition>
                <RowDefinition Height="40"></RowDefinition>
                <RowDefinition Height="40"></RowDefinition>
                <RowDefinition Height="100"></RowDefinition>
                <RowDefinition></RowDefinition>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="90*"></ColumnDefinition>
                <ColumnDefinition Width="40"></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <Label x:Name="lblFileSelect"
                   Content="当前文件："
                   HorizontalAlignment="Left"
                   VerticalAlignment="Bottom"
                   Grid.Row="2"
                   Margin="0,0,0,7" />
            <TextBox x:Name="txtFilePath"
                     HorizontalAlignment="Left"
                     Height="24"
                     TextWrapping="NoWrap"
                     Text=""
                     VerticalAlignment="Center"
                     Grid.Row="2"
                     Grid.Column="0"
                     Margin="75,8,0,8"
                     BorderThickness="1"
                     Width="178" />
            <Button x:Name="btnSelectFile"
                    Content="..."
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"
                    Grid.Row="2"
                    Margin="260,9,0,9"
                    BorderThickness="0"
                    Click="SelectImportedFile"
                    Width="25" />

            <Label x:Name="lblIntrduction"
                   Content="当前模板："
                   HorizontalAlignment="Left"
                   Margin="0,10,0,0"
                   VerticalAlignment="Top"
                   Grid.Row="0" />
            <Label x:Name="lblCurTemplate"
                   Content="未选择"
                   HorizontalAlignment="Left"
                   Margin="78,11,0,0"
                   Foreground="Red"
                   VerticalAlignment="Top"
                   Grid.Row="0" />
            <Label x:Name="lblIntrduction_Copy"
                   Content="当前规则："
                   HorizontalAlignment="Left"
                   Margin="0,10,0,0"
                   VerticalAlignment="Top"
                   Grid.Row="1" />
            <Label x:Name="lblCurRule"
                   Content="未解析"
                   HorizontalAlignment="Left"
                   Margin="78,11,0,0"
                   Foreground="Red"
                   VerticalAlignment="Top"
                   Grid.Row="1" />
            <Button x:Name="btnAnalysisView"
                    Content="查看规则"
                    HorizontalAlignment="Right"
                    Grid.Row="1"
                    Grid.Column="0"
                    VerticalAlignment="Center"
                    Width="70"
                    Margin="0,13,15,5"
                    Click="ViewRules"
                    Grid.ColumnSpan="2" />
            <Button x:Name="btnAnalysis"
                    Content="解析规则"
                    HorizontalAlignment="Right"
                    Grid.Row="0"
                    Grid.Column="0"
                    VerticalAlignment="Center"
                    Width="70"
                    Margin="0,13,15,5"
                    Click="AnalysisFile"
                    Grid.ColumnSpan="2" />
            <Button x:Name="btnGetDate"
                    Content="提取数据"
                    HorizontalAlignment="Right"
                    Grid.Row="2"
                    Grid.Column="0"
                    VerticalAlignment="Center"
                    Width="70"
                    Margin="0,10,15,8"
                    Click="GetData"
                    Grid.ColumnSpan="2" />
            <TextBox x:Name="txtProcess"
                     Grid.Row="3"
                     HorizontalAlignment="Stretch"
                     TextWrapping="Wrap"
                     Text="此处显示解析和提取数据进度"
                     VerticalAlignment="Stretch"
                     Grid.ColumnSpan="2"
                     Margin="0,10,15,0" />
        </Grid>
        <Grid Grid.Column="2"
              HorizontalAlignment="Stretch"
              VerticalAlignment="Stretch">
            <Grid.RowDefinitions>
                <RowDefinition Height="30"></RowDefinition>
                <RowDefinition Height="40"></RowDefinition>
                <RowDefinition Height="50"></RowDefinition>
                <RowDefinition></RowDefinition>
            </Grid.RowDefinitions>
            <Label x:Name="label"
                   Content="关系库连接字符串:"
                   HorizontalAlignment="Left"
                   VerticalAlignment="Top"
                   Grid.Row="0"
                   Margin="10,4,0,0" />
            <TextBox x:Name="txtDBConnectInfo"
                     Grid.Row="1"
                     HorizontalAlignment="Stretch"
                     TextWrapping="Wrap"
                     Text="data source=server27;user id=sistest;password=sistest;"
                     VerticalAlignment="Top"
                     Margin="10,0,12,0"
                     Height="40" />
            <Button x:Name="btnTestDBConnect"
                    Content="测试"
                    Grid.Row="2"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Bottom"
                    Width="49"
                    Margin="0,0,76,8"
                    Click="TestDBConnect" />
            <Button x:Name="btnImport"
                    Content="导入"
                    Grid.Row="2"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Bottom"
                    Width="48"
                    Margin="0,0,12,8"
                    Click="Import" />
            <TextBox x:Name="txtImportProcess"
                     Grid.Row="3"
                     HorizontalAlignment="Stretch"
                     TextWrapping="Wrap"
                     Text="此处显示导入进度"
                     VerticalAlignment="Stretch"
                     Margin="10" />
            <Button x:Name="btnSaveConnect"
                    Content="保存"
                    Grid.Row="2"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Bottom"
                    Width="49"
                    Margin="0,0,140,8"
                    Click="SaveConnection" />

        </Grid>
    </Grid>
</Window>
